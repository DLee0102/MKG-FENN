# 记录一些灵光一现

## 2024-09-29
```python
# modeltask2.py

if train_or_test == 1:
    for i in test_adj[0].keys():
        pos = test_adj[0][i][0]
        length = len(pos)
        
        # 选择出相似度较高的训练集中的药物来得到测试集的embedding
        drug_f[i] = torch.sum(drug_f[pos], dim=0) / length
return drug_f, idx, test_adj, train_or_test
```
这里用训练集的embedding来初始化测试集的embedding，更加说明了测试集和训练集的关联程度会对预测结果造成较大影响；
<br/>
或者说这里用到了节点相似性的先验知识，做了一次feature augmentation